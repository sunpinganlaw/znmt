<!doctype html>
<html>
<head>
<meta charset="utf-8">
    <base href="${base}/">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <#include "/include/common.html"/>
<title>打印汽车计量单</title>
<style type="text/css">
    body{ background-color:#fff; color:#000; font-size:0.9em; width:1000px; margin:0 auto;}
    h1{ font-size:2em; text-align:center; line-height:2em;}
    table.table01{border-left:1px solid #000;border-top:1px solid #000;border-bottom:1px solid #000;}
    table.table01 td{ border-right:1px solid #000;border-bottom:1px solid #000; padding:5px;}

    table.table02{ border-left:1px solid #000;}
    table.table02 td{ border-right:1px solid #000;border-bottom:1px solid #000; padding:5px;}

    .styip01 input{ margin-right:12px;}
    input[type=checkbox]{ vertical-align:middle;}
    .stymr01{ margin-right:100px;}
    .stymr02{ margin-right:40px;}
</style>
</head>

<body>
<!--startprint-->
<h1>哈尔滨热电有限公司汽车计量单</h1>

<div style=" width: 98%">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;批次号：<span id="batchNoPrnt">&nbsp;</span>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打印时间：<span id="DtmPrnt">&nbsp;</span>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;重量单位：<span>吨</span>
</div>
<div style=" width: 10%">&nbsp;</div>

<table id="printTable" width="98%" border="0" cellspacing="0" cellpadding="0" class="table01">
    <tr>
        <td style="text-align:center;font-size:1.5em;" width="7%">序号</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">磅单号</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">车号</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">毛重</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">皮重</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">净重</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">扣重</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">实重</td>
        <td style="text-align:center;font-size:1.5em;" width="13%">发货单位</td>
        <td style="text-align:center;font-size:1.5em;" width="7%">货名</td>
        <td style="text-align:center;font-size:1.5em;" width="12%">毛重时间</td>
        <td style="text-align:center;font-size:1.5em;" width="12%">皮重时间</td>
    </tr>
</table>

<div style=" width: 10%">&nbsp;</div>
<div style=" width: 98%">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制表：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;审核：
</div>

<!--endprint-->

<div>&nbsp;</div>
<div style="text-align: right; width: 90%">
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-print" onclick="printJLD();">打印</a>
</div>

</body>
</html>

<script type="text/javascript">
    $(function(){
        var batchNo = JSON.stringify("${batchNo}").replaceAll("\"","");
        var paramsObj = {};
        paramsObj.search_batchNo = batchNo;

        var czDtm = " ";
        var totalMz = 0;
        var totalPz = 0;
        var totalNet = 0;
        var totalYk = 0;
        var totalSz = 0;

        $.post("${base}/business/report/weightRptListNoPage", paramsObj, function(rsp) {
            var arr = rsp.rows;
            var table1 = $('#printTable');
            for (var i=0; i<arr.length; i++) {
                var row = $("<tr></tr>");
                var td = $("<td style='text-align:center;'>"+
                        (i+1)+"</td><td style='text-align:center;'>"+
                        (arr[i].recordNo==null?"&nbsp;":arr[i].recordNo)+"</td><td style='text-align:center;'>"+
                        (arr[i].carId==null?"&nbsp;":arr[i].carId)+"</td><td style='text-align:center;'>"+
                        (arr[i].mzQty==null?"&nbsp;":arr[i].mzQty)+"</td><td style='text-align:center;'>"+
                        (arr[i].pzQty==null?"&nbsp;":arr[i].pzQty)+"</td><td style='text-align:center;'>"+
                        (arr[i].netQty==null?"&nbsp;":arr[i].netQty)+"</td><td style='text-align:center;'>"+
                        (arr[i].ydQty==null?"&nbsp;":arr[i].ydQty)+"</td><td style='text-align:center;'>"+
                        (arr[i].netQty==null?"&nbsp;":arr[i].netQty)+"</td><td style='text-align:center;'>"+
                        (arr[i].venNam==null?"&nbsp;":arr[i].venNam)+"</td><td style='text-align:center;'>"+
                        (arr[i].coalNam==null?"&nbsp;":arr[i].coalNam)+"</td><td style='text-align:center;'>"+
                        (arr[i].czDtm==null?"&nbsp;":arr[i].czDtm)+"</td><td style='text-align:center;'>"+
                        (arr[i].jqDtm==null?"&nbsp;":arr[i].jqDtm)+"</td>");
                row.append(td);
                table1.append(row);

                totalMz = totalMz + parseFloat(arr[i].mzQty==null?"0":arr[i].mzQty);
                totalPz = totalPz + parseFloat(arr[i].pzQty==null?"0":arr[i].pzQty);
                totalNet = totalNet + parseFloat(arr[i].netQty==null?"0":arr[i].netQty);
                totalYk = totalYk + parseFloat(arr[i].ydQty==null?"0":arr[i].ydQty);
                totalSz = totalSz + parseFloat(arr[i].netQty==null?"0":arr[i].netQty);
            }


            var row = $("<tr></tr>");
            var td = $("<td style='text-align:center;font-size:1.5em;'>合计</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>"+
                    "<td style='text-align:center;font-size:1.5em;'>"+totalMz.toFixed(2)+"</td>"+
                    "<td style='text-align:center;font-size:1.5em;'>"+totalPz.toFixed(2)+"</td>"+
                    "<td style='text-align:center;font-size:1.5em;'>"+totalNet.toFixed(2)+"</td>"+
                    "<td style='text-align:center;font-size:1.5em;'>"+totalYk.toFixed(2)+"</td>"+
                    "<td style='text-align:center;font-size:1.5em;'>"+totalSz.toFixed(2)+"</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>"+
                    "<td style='text-align:center;'>&nbsp;</td>");
            row.append(td);
            table1.append(row);

            document.getElementById("batchNoPrnt").innerText =  batchNo;

            //从服务器取打印时间
            $.post("${base}/business/tool/getCurrentTime", function (rsp) {
                if (rsp) {
                    document.getElementById("DtmPrnt").innerText =  new Date(parseInt(parseInt(rsp)) * 1000).toLocaleString();
                } else {
                    showMsg("提示", "获取服务器当前时间失败!");
                    return false;
                }
            });
        });
    });

    function printJLD() {
        var bdhtml = window.document.body.innerHTML;
        var sprnstr = "<!--startprint-->";
        var eprnstr = "<!--endprint-->";
        var prnhtml = bdhtml.substr(bdhtml.indexOf(sprnstr)+17);
        prnhtml = prnhtml.substring(0,prnhtml.indexOf(eprnstr));
        window.document.body.innerHTML=prnhtml;
        window.print();
    }
</script>