<!doctype html>
<html>
<head>
<meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <#include "/include/common.html"/>
<title>化验报告</title>

<style type="text/css">
	body{ background-color:#fff; color:#000; font-size:0.9em; width:1000px; margin:0 auto;}
	h1{ font-size:2em; text-align:center; line-height:2em; position:relative;}
	.num{ position:absolute; right:130px; top:30px; font-size:0.5em; font-weight:normal; line-height:4em;}
	.numright{ text-align:right; margin-right:130px;}
	table.table01{border:3px solid #000;}
	table.table01 td{ border-right:1px solid #000;border-bottom:1px solid #000; padding:20px 5px; text-align:center; font-weight:bold;}
	table.table01 td.letter{ font-size:1.3em; }
	table.table01 td.letter sub sub{ font-size:0.3em;}
	.styip01 input{ margin-right:12px;}
	input[type=checkbox]{ vertical-align:middle;}
	.stymr01{ margin-right:100px;}
	.stymr02{ margin-right:40px;}
	
</style>

</head>

<body>
<!--startprint-->
<p>&nbsp;</p>
<h1>抽样对比化验报告</h1>
<!--<p class="numright">编号：</p>-->
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="table01">
  <tr>
    <td>化验编码</td>
    <td colspan="4" id="laborCode">&nbsp;</td>
  </tr>
  <tr>
    <td width="20%">化验指标</td>
    <td width="20%">原始值</td>
    <td width="20%">抽检值</td>
    <td width="20%">差值</td>
    <td width="20%">结论</td>
  </tr>
  <tr>
    <td><span class="letter">A<sub>d</sub></span></td>
    <td id="preAd">&nbsp;</td>
    <td id="sampleAd">&nbsp;</td>
    <td id="deviationAd">&nbsp;</td>
    <td id="resultAd">&nbsp;</td>
  </tr>
  <tr>
    <td><span class="letter">V<sub>d</sub></span></td>
    <td id="preVd">&nbsp;</td>
    <td id="sampleVd">&nbsp;</td>
    <td id="deviationVd">&nbsp;</td>
    <td id="resultVd">&nbsp;</td>
  </tr>
  <tr>
    <td><span class="letter">S<sub>t<sub>,</sub>d</sub></span></td>
    <td id="preStd">&nbsp;</td>
    <td id="sampleStd">&nbsp;</td>
    <td id="deviationStd">&nbsp;</td>
    <td id="resultStd" >&nbsp;</td>
  </tr>
  <tr>
    <td><span class="letter">Q<sub>gr<sub>,</sub>d</sub></span></td>
    <td id="preQgrd">&nbsp;</td>
    <td id="sampleQgrd">&nbsp;</td>
    <td id="deviationQgrd">&nbsp;</td>
    <td id="resultQgrd">&nbsp;</td>
  </tr>
  <tr>
    <td>原始工业分析：</td>
    <td>&nbsp;</td>
    <td>抽检工业分析：</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>原始发热量：</td>
    <td>&nbsp;</td>
    <td>抽检发热量：</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>原始化验日期：</td>
    <td id="predate">&nbsp;</td>
    <td>抽检化验日期：</td>
    <td id="sampledate">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>审核</td>
    <td colspan="4">&nbsp;</td>
  </tr>
</table>
<!--endprint-->

<div id="printButton" style="text-align: right">&nbsp;</div>
</body>

<script type="text/javascript">
  $(function(){
    var labReportData = ${SampleLabReportData};

      console.log(labReportData);
    document.getElementById("printButton").innerHTML ='<a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-print" onclick="printLabRpt();">打印</a>';

    document.getElementById("laborCode").innerHTML = labReportData.labor_code;
    document.getElementById("preAd").innerHTML = toDecimal(labReportData.preAd, 2);
    document.getElementById("sampleAd").innerHTML = toDecimal(labReportData.sampleAd, 2);
    document.getElementById("deviationAd").innerHTML = toDecimal(labReportData.deviationAd, 2);
    if(labReportData.resultAd == "YES"){
      document.getElementById("resultAd").innerHTML = "合格";
    }else {
      document.getElementById("resultAd").innerHTML = "不合格";
    }
    document.getElementById("preVd").innerHTML = toDecimal(labReportData.preVd, 2);
    document.getElementById("sampleVd").innerHTML = toDecimal(labReportData.sampleVd, 2);
    document.getElementById("deviationVd").innerHTML = toDecimal(labReportData.deviationVd, 2);
    if(labReportData.resultVd == "YES"){
      document.getElementById("resultVd").innerHTML = "合格";
    }else {
      document.getElementById("resultVd").innerHTML = "不合格";
    }
    document.getElementById("preStd").innerHTML = toDecimal(labReportData.preStd, 2);
    document.getElementById("sampleStd").innerHTML = toDecimal(labReportData.sampleStd, 2);
    document.getElementById("deviationStd").innerHTML = toDecimal(labReportData.deviationStd, 2);
    if(labReportData.resultStd == "YES"){
      document.getElementById("resultStd").innerHTML = "合格";
    }else {
      document.getElementById("resultStd").innerHTML = "不合格";
    }
    document.getElementById("preQgrd").innerHTML = toDecimal(labReportData.preQgrd, 2);
    document.getElementById("sampleQgrd").innerHTML = toDecimal(labReportData.sampleQgrd, 2);
    document.getElementById("deviationQgrd").innerHTML = toDecimal(labReportData.deviationQgrd, 2);
    if(labReportData.resultQgrd == "YES"){
      document.getElementById("resultQgrd").innerHTML = "合格";
    }else {
      document.getElementById("resultQgrd").innerHTML = "不合格";
    }
    document.getElementById("predate").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;"+labReportData.hy_date;
    document.getElementById("sampledate").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;"+labReportData.sample_date;
  });

  function printLabRpt() {
    var bdhtml = window.document.body.innerHTML;
    var sprnstr = "<!--startprint-->";
    var eprnstr = "<!--endprint-->";
    var prnhtml = bdhtml.substr(bdhtml.indexOf(sprnstr)+17);
    prnhtml = prnhtml.substring(0,prnhtml.indexOf(eprnstr));
    window.document.body.innerHTML=prnhtml;
    window.print();
  }

  function toDecimal(x, bit) {
    var f = parseFloat(x);
    if (isNaN(f)) {
      return false;
    }
    var f = Math.round(x*Math.pow(10,bit))/Math.pow(10,bit);
    var s = f.toString();
    var rs = s.indexOf('.');
    if (rs < 0) {
      rs = s.length;
      s += '.';
    }
    while (s.length <= rs + parseInt(bit)) {
      s += '0';
    }
    return s;
  }
</script>