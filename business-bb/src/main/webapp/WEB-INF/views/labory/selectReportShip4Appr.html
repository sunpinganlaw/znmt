    <div id="selectTb">
        <table>
            <tr>
                <td>
                    <input type="button" onclick="submitAppr();" value="确定"/>
                </td>

            </tr>
        </table>
    </div>

    <div id="spl" style="margin: 5px;width: 99%">
        <table id="shipListDg" ></table>
    </div>

<script type="text/javascript">

$shipListDg = $("#shipListDg");

//初始化查询
$(function () {
    var paramObj = {};
    var myDate = new Date();
    var qryBeginDate = getDateStr(-100);
    var qryEndDate =  myDate.getFullYear()+"-"+(parseInt(myDate.getMonth())+1)+"-"+myDate.getDate();

    paramObj.search_beginDate = qryBeginDate;
    paramObj.search_endDate = qryEndDate;

    $shipListDg.datagrid({
        url: "${base}/business/monitor/qryShipTransInfo",
        fitColumns: true,
        width: 465,
        height: 290,
        idField: 'shipRecID',
        singleSelect:true,
        rownumbers:true,
        queryParams:paramObj,
        columns: [
            [   {field: 'shipRecID', title: 'ID',align:'center', width:25, checkbox:true},
                {field: 'shipTransNo', title: '运输编号',align:'center', width:80},
                {field: 'shipCode', title: '船名',align:'center', width:60},
                {field: 'shipName', title: '船号',align:'center', width:60},
                {field: 'factTime', title: '到港时间',align:'center', width:100}
            ]
        ],
        toolbar: '#selectTb'
    });
});

//发送采样机操作的命令
function submitAppr(){
    var selectedRow = $shipListDg.datagrid('getSelected');
    if (selectedRow) {
        var shipRecId = selectedRow.shipRecID;

        var paramObj = new Object();
        paramObj.search_shipRecID = shipRecId;
        paramObj.search_batchType = '';
        paramObj.search_apprEventTypeCd = '5';//审批事件类型，5生成化验报告
        $.messager.confirm('提示', '一艘船的所有化验批次都生成报告后才能提交审批，确定继续?', function (r) {
            if (r) {
                $('#selectShipWin').window('close');
                $.post("${base}/business/labory/labReport2Appr", paramObj, function(rsp) {
                    if(rsp.successful){
                        //加载数据
                        $reportQryDg.datagrid("reload");

                        showMsg("提示", " 化验报告审批请求已提交成功，等审批通过后系统将可以打印化验报告。");
                    } else {
                        showMsg("提示", rsp.msg);
                    }
                });
            }
        });
    } else {
        showMsg("提示",  "请选择船!");
        return false;
    }
}

function getDateStr(addDayCount){
    var strDate = new Date();
    var beginDate = strDate.getTime();
    var endDate = beginDate + (parseInt(addDayCount)*24*60*60*1000);
    strDate.setTime(endDate);
    var dtStart=new Date(strDate);
    return  dtStart.getFullYear()+"-"+(parseInt(dtStart.getMonth())+1)+"-"+dtStart.getDate();
}

</script>
